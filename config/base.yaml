#!/usr/bin/env python3
# -*- coding:utf-8 -*-
# ================================================================================================ #
# Project    : AppStoreStream: Apple App Data and Reviews, Delivered!                              #
# Version    : 0.1.0                                                                               #
# Python     : 3.10.14                                                                             #
# Filename   : /config/base.yaml                                                                   #
# ------------------------------------------------------------------------------------------------ #
# Author     : John James                                                                          #
# Email      : john@variancexplained.com                                                           #
# URL        : https://github.com/variancexplained/appstore-stream.git                             #
# ------------------------------------------------------------------------------------------------ #
# Created    : Friday July 19th 2024 04:22:54 am                                                   #
# Modified   : Thursday July 25th 2024 12:20:30 am                                                 #
# ------------------------------------------------------------------------------------------------ #
# License    : MIT License                                                                         #
# Copyright  : (c) 2024 John James                                                                 #
# ================================================================================================ #
# ================================================================================================ #
#                                 BASE CONFIG FILE                                                 #
# ================================================================================================ #

# ------------------------------------------------------------------------------------------------ #
#                               APP DATA CONFIG SECTION                                            #
# ------------------------------------------------------------------------------------------------ #
appdata:
  application:
    max_requests: 2000000 # Estimated 10m requests assuming
    batch_size: 100 # Size of the async batch of requests.
    url:
      scheme: https
      host: itunes.apple.com
      command: "search?"
    params:
      term: app
      media: software
      country: us
      lang: "en-us"
      explicit: "yes"
      limit: 200 # Maximum records per page.
  infrastructure:
    database:
      backup: 1000 # Backup working database every 1000 async batches
    web:
      async_request:
        max_concurrency: 10
        retries: 3
        timeout: 30
      throttle: # HTTP Request Throttling Config
        burnin_period: 50 # The number of requests in the burn-in period. Default is 50
        burnin_reset: 1000 # The number of requests between each burnin period.
        burnin_request_rate: 1 # The number of requests per second during the burn-in period. Default is 1
        burnin_threshold_factor: 2 #  The number of standard deviations above mean latency that would trigger a cooldown.
        rolling_window_size: 25
        cooldown_factor: 2 # The number by which the delay is multiplied during each cooldown phase.
        cooldown_phase: 25 # Length of cooldown phase
        tolerance: 0.8 #  Proportion of the rolling window above threshold that is allowed before cooldown.
        base_request_rate: 1 # The number of requests per second after burn-in. Default is 1.

# ------------------------------------------------------------------------------------------------ #
#                                APP REVIEW CONFIG SECTION                                         #
# ------------------------------------------------------------------------------------------------ #
review:
  application:
    max_requests: 1.8446744e+19
    batch_size: 100
    max_results_per_page: 400
  infrastructure:
    database:
      backup: 1000 # Backup working database every 1000 async batches
    web:
      async_request:
        max_concurrency: 10
        retries: 3
        timeout: 30
      throttle: # HTTP Request Throttling Config
        burnin_period: 50 # The number of requests in the burn-in period. Default is 50
        burnin_reset: 1000 # The number of requests between each burnin period.
        burnin_rate: 1 # The number of requests per second during the burn-in period. Default is 1
        burnin_threshold_factor: 2 #  The number of standard deviations above mean latency that would trigger a cooldown.
        rolling_window_size: 25
        cooldown_factor: 2 # The number by which the delay is multiplied during each cooldown phase.
        cooldown_phase: 25 # Length of cooldown phase
        tolerance: 0.8 #  Proportion of the rolling window above threshold that is allowed before cooldown.
        rate: 1 # The number of requests per second after burn-in. Default is 1.

# ------------------------------------------------------------------------------------------------ #
#                                     LOGGING                                                      #
# ------------------------------------------------------------------------------------------------ #
logging:
  disable_existing_loggers: false
  formatters:
    console:
      datefmt: "%m/%d/%Y %I:%M:%S %p"
      format: "[%(asctime)s] [%(levelname)s] [%(name)s] [%(funcName)s] : %(message)s"
    file:
      datefmt: "%m/%d/%Y %I:%M:%S %p"
      format:
        "[%(asctime)s] [%(levelname)s] [%(name)s] [%(module)s] [%(funcName)s]
        : %(message)s"
  handlers:
    console:
      class: logging.StreamHandler
      formatter: console
      level: INFO
      stream: ext://sys.stderr
    file:
      backupCount: 0
      class: logging.handlers.TimedRotatingFileHandler
      filename: logs/appvoc.log
      formatter: file
      interval: 1
      level: DEBUG
      when: midnight
  root:
    handlers:
      - console
      - file
    level: DEBUG
  version: 1

# ------------------------------------------------------------------------------------------------ #
#                                 CLOUD STORAGE CONFIG                                             #
# ------------------------------------------------------------------------------------------------ #
cloud:
  aws_bucket: appvoc
  aws_appdata_folder: appdata
  aws_review_folder: reviews

# ------------------------------------------------------------------------------------------------ #
#                                     MONITOR CONFIG                                               #
# ------------------------------------------------------------------------------------------------ #
monitor:
  rate_update_interval: 15 # Number of seconds between rate updates

# ------------------------------------------------------------------------------------------------ #
#                              CATEGORY SEARCH CONFIG                                              #
# ------------------------------------------------------------------------------------------------ #
category:
  6000:
    category: Business
    gaming: false
    pty: 1
    term: business
  6001:
    category: Weather
    gaming: false
    pty: 3
    term: weather
  6002:
    category: Utilities
    gaming: false
    pty: 1
    term: utilities
  6003:
    category: Travel
    gaming: false
    pty: 2
    term: travel
  6004:
    category: Sports
    gaming: false
    pty: 2
    term: sports
  6005:
    category: Social Networking
    gaming: false
    pty: 2
    term: social
  6006:
    category: Reference
    gaming: false
    pty: 2
    term: reference
  6007:
    category: Productivity
    gaming: false
    pty: 1
    term: productivity
  6008:
    category: Photo & Video
    gaming: false
    pty: 2
    term: photo
  6009:
    category: News
    gaming: false
    pty: 3
    term: news
  6010:
    category: Navigation
    gaming: false
    pty: 3
    term: navigation
  6011:
    category: Music
    gaming: false
    pty: 3
    term: music
  6012:
    category: Lifestyle
    gaming: false
    pty: 1
    term: lifestyle
  6013:
    category: Health & Fitness
    gaming: false
    pty: 1
    term: health
  6014:
    category: Games
    gaming: false
    pty: 4
    term: games
  6015:
    category: Finance
    gaming: false
    pty: 2
    term: finance
  6016:
    category: Entertainment
    gaming: false
    pty: 2
    term: entertainment
  6017:
    category: Education
    gaming: false
    pty: 1
    term: education
  6018:
    category: Books
    gaming: false
    pty: 2
    term: books
  6020:
    category: Medical
    gaming: false
    pty: 2
    term: medical
  6021:
    category: Newsstand
    gaming: false
    pty: 3
    term: newsstand
  6022:
    category: Catalogs
    gaming: false
    pty: 3
    term: catalogs
  6023:
    category: Food & Drink
    gaming: false
    pty: 1
    term: food
  6024:
    category: Shopping
    gaming: false
    pty: 2
    term: shopping
  6026:
    category: Developer Tools
    gaming: false
    pty: 3
    term: developer
  6027:
    category: Graphics & Design
    gaming: false
    pty: 3
    term: graphics
  7001:
    category: Game Action
    gaming: true
    pty: 4
    term: game
  7002:
    category: Game Adventure
    gaming: true
    pty: 4
    term: game
  7003:
    category: Game Casual
    gaming: true
    pty: 4
    term: game
  7004:
    category: Game Board
    gaming: true
    pty: 4
    term: game
  7005:
    category: Game Card
    gaming: true
    pty: 4
    term: game
  7006:
    category: Game Casino
    gaming: true
    pty: 4
    term: game
  7007:
    category: Game Dice
    gaming: true
    pty: 4
    term: game
  7008:
    category: Game Educational
    gaming: true
    pty: 4
    term: game
  7009:
    category: Game Family
    gaming: true
    pty: 4
    term: game
  7010:
    category: Game Kids
    gaming: true
    pty: 4
    term: game
  7011:
    category: Game Music
    gaming: true
    pty: 4
    term: game
  7012:
    category: Game Puzzle
    gaming: true
    pty: 4
    term: game
  7013:
    category: Game Racing
    gaming: true
    pty: 4
    term: game
  7014:
    category: Game Role Playing
    gaming: true
    pty: 4
    term: game
  7015:
    category: Game Simulation
    gaming: true
    pty: 4
    term: game
  7016:
    category: Game Sports
    gaming: true
    pty: 4
    term: game
  7017:
    category: Game Strategy
    gaming: true
    pty: 4
    term: game
  7018:
    category: Game Trivia
    gaming: true
    pty: 4
    term: game
  7019:
    category: Game Word
    gaming: true
    pty: 4
    term: game
